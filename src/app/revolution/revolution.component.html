<div>
  <h1 class="ui header">{{ hashtag }}</h1>
  <p><strong>Up to {{ convertToFiat(distributionAmount) }} {{ currency() }} ({{ distributionAmount }} ETH) every {{ distributionPeriod.toFixed(1) }} {{ distributionPeriodUnit }} for {{ criteria }}</strong></p>

 <div class="ui segment" id="discuss">
  <h3 class="ui header">1. Who does or does not match this criteria?</h3>
  <div class="content">Discover it <a href="https://twitter.com/hashtag/{{ hashtagWithoutSymbol }}" target="_blank">on social media <span id="hashtag">{{ hashtag }}</span></a> or offline. Ask for their Ethereum address. Demand proofs that they really are {{ criteria }}. Verify them. Challenge them. Debate. Build your opinion.</div>
 </div>
 

 <div class="ui segment" id="vote">
  <h3 class="ui header">2. Are they really {{criteria}} ?</h3>
  <div class="ui relaxed celled list">
   <div class="item">
    <div class="content">
     <div class="header"><label>Bet and vote on their trial, see consensual verdicts</label></div>
    </div>
   </div>
  </div>
  <div class="ui relaxed celled list" *ngFor="let citizen of citizens">
   <div class="item">
    <i class="large balance scale middle aligned icon"></i>
    <div class="content" #userInput>
     <button
      class="ui button"
      type="button"
      ngxClipboard
      [cbContent]="citizen.address"
      (cbOnSuccess)="copied = citizen.address"
      [class.btn-success]="copied == citizen.address"
      attr.data-tooltip="Their Ethereum address: {{ citizen.address }}. Click to copy it."
      data-position="top left">
      {{ (citizen.address | slice:0:8)+'...' }}<span *ngIf="copied == citizen.address"> Copied</span>
     </button>
     <a [routerLink]="['/citizen', citizen.address]">
      <div *ngIf="citizen.opened" class="ui tag label">No consensual verdict yet: {{ citizen.sansculotteScale / 1000000000000000000 }} ETH on YES vs. {{ citizen.privilegedScale / 1000000000000000000 }} ETH on NO</div>
      <div *ngIf="!citizen.opened && citizen.matchesCriteria" class="ui green tag label"><i class="thumbs up icon"></i> Consensual verdict: YES, they are.{{ (citizen.sansculotteScale != 0) ? ' And '+(citizen.sansculotteScale / 1000000000000000000)+' ETH more is on YES.':'' }}</div>
      <div *ngIf="!citizen.opened && !citizen.matchesCriteria"  class="ui red tag label"><i class="thumbs down icon"></i> Consensual verdict: NO, they are not.{{ (citizen.privilegedScale != 0) ? ' And '+(citizen.privilegedScale / 1000000000000000000)+' ETH is still on NO.':'' }}</div>
      <button class="ui left labeled icon button secondary" data-tooltip="Click to vote and bet." data-position="top right"><i class="envelope icon"></i><span *ngIf="citizen.opened">Cast your vote and bet: YES or NO ?</span><span *ngIf="!citizen.opened">Re-open their trial</span></button>
     </a>
    </div>
   </div>
  </div>
 </div>
 
 
  <div class="ui segment" id="add">
  <h3 class="ui header">3. What's a new Ethereum address to be put on trial?</h3>
  <div class="content">You can add your own address if you are {{ criteria }}. Your address can be copied from your Ethereum wallet (Metamask, Coinbase, ...).</div>
  <div class="content"><a routerLink="/citizen">
   <button class="ui left labeled icon secondary button" data-tooltip="Click to register a new address and bet and vote about it.">
    <i class="envelope scale icon"></i>
    Add the Ethereum address of <strong>{{ criteria }}</strong>
   </button>
  </a></div>
 </div>
 
 
  <div class="ui segment form">
  <h3 class="ui header">4. Donate Eth to be distributed</h3>
  This revolution collects donations sent to the address <a href="#" (click)="fullAddressShown = !fullAddressShown"><span *ngIf="!fullAddressShown">{{ (revolutionAddress.length>8)? (revolutionAddress | slice:0:8)+'...':(revolutionAddress) }}</span><span *ngIf="fullAddressShown">{{ revolutionAddress }}</span></a> on the Ethereum {{ revolutionBlockchain }} blockchain. 100% of these donations are directly re-distributed as income, minus transaction safety fees (also known as network mining fees).

  <div class="field">
   <label>Current amount in this revolution</label>
   <div class="ui large label">
    <span id="balance">
     {{ bastilleBalance }}
    </span> ETH
   </div>
   <div class="ui action input">
    <div class="ui right aligned label" style="text-align:right;">= {{ convertToFiat(bastilleBalance) }}</div>
   <select (change)="onCurrencyChange($event)" class="ui compact dropdown label" style="max-width:6em;">
    <option value="EUR" [selected]="currency() == 'EUR'">€</option>
    <option value="USD" [selected]="currency() == 'USD'">$</option>
    <option [selected]="currency() == 'AUD'">AUD</option>
    <option [selected]="currency() == 'CAD'">CAD</option>
    <option [selected]="currency() == 'CNY'">CNY</option>
    <option value="GBP" [selected]="currency() == 'GBP'">£</option>
    <option value="JPY" [selected]="currency() == 'JPY'">¥</option>
   </select>
    </div>
   </div>

   <a class="ui button primary" routerLink="/donate">
    <i class="heart icon"></i>
    Donate this revolution
   </a>
 </div>
 
 
 <div class="ui segment" id="trust">
  <h3 class="ui header">5. How much can you trust this app?</h3>
 
  <p id="criteriaLabel"> The owners of the addresses listed above get an income from this app if and only if they are <strong class="criteria" id="criteria">{{ criteria }}</strong> according to the consensual verdict of their trial. Their income is then, at most, of {{ distributionAmount }} ETH every {{ distributionBlockPeriod }} blocks of the Ethereum {{ revolutionBlockchain }} blockchain (about {{ convertToFiat(distributionAmount) }} {{ currency() }} every {{ distributionPeriod.toFixed(1) }} {{ distributionPeriodUnit }}) unless this revolution is empty and needs further donations. First addresses added above get their income first. Last addresses may not get any income during this distribution round if the revolution is empty. Distribution rounds are triggered by new votes. Voters pay mining fees. Voters earn ETH if the consensual verdict is aligned with their vote and loose their bet otherwise. </p>

  <p> These rules are hard-coded into a smart contract running on the public Ethereum blockchain. It may still contain bugs or design flaws or security vulnerabilities. But <a href="https://{{ revolutionBlockchain == 'Main' || revolutionBlockchain == 'Mainnet' || revolutionBlockchain == 'Unknown' ? 'www' : revolutionBlockchain.toLowerCase() }}.etherscan.io/address/{{ revolutionAddress }}" target="_blank">you can read and verify its open source code and history of transactions</a>. The source code of current web interface you are using <a href="https://github.com/siggg/culottes" target="_blank">can be audited  from your web browser and from  github</a>. <a href="https://{{ revolutionBlockchain == 'Main' || revolutionBlockchain == 'Mainnet' || revolutionBlockchain == 'Unknown' ? 'www' : revolutionBlockchain.toLowerCase() }}.etherscan.io/dapp/{{ revolutionAddress }}" target="_blank">You can also use an alternative less convenient web interface</a>.</p>
 
 <p> According to the source code of this web interface and of the smart contract, your Ethereum money, once donated to this app, gets strictly out of the reach of any human being. Contrary to a non profit organization managing donations or to a state managing taxes, this system is not governed by humans but by fully automated code which was written and published by humans. Nobody (even the authors of this code) can retrieve the money donated to this revolution except by receiving a "YES" consensual verdict from voters. Anyone can vote. People can be influenced or coerced into voting unfairly but the rules coded are designed to incentivize anyone to vote reasonably and against anyone trying to fool others : the more honestly you vote, the more chance you have to vote as the majority of voters will. So the higher the probability you will win the trial and receive a fair share of the money put on stake by the loosing minority of voters. The more malicious voters lie while voting, the more money they put at stake, the more money anyone can make by voting against them and promoting the verifiable  truth so that the majority of the crowd will see who has more chance to win.</p>
 <p> You can challenge and discuss this publicly <a href="https://twitter.com/hashtag/{{ hashtagWithoutSymbol }}" target="_blank">on Twitter <span id="hashtag">{{ hashtag }}</span></a>.</p>
</div>


 <div class="ui segment">Status:
  <div [innerHTML]="web3Status"></div>
  <div class="field">
   <label>Address of this revolution</label>
   <div class="ui label">{{ revolutionAddress }} on the {{ revolutionBlockchain }} blockchain</div>
  </div>
  <div class="field">
   <label><a href="https://github.com/Siggg/culottes/blob/master/how_to.md" target="_blank">Spark a revolution for your own cause or join another revolution</a></label>
   <select (change)="onRevolutionChange($event)" class="ui compact dropdown label">
	   <option *ngFor="let revolution of otherRevolutions | keyvalue" value="{{ revolution.key }}" [selected]="revolution.value == hashtag">{{ revolution.value }}</option>
   </select>
  </div>
 </div>

<div class="ui {{ lockModalActivity }} modal">
  <div class="ui icon header">
    <i class="lock icon"></i>
    Locked
  </div>
  <div class="ui content">
    <p>This contract has been locked by its owner. You can still vote for and against addresses as long as there is some ETH left in this revolution. But you can't donate any more ETH to this revolution. And votes are closed once this revolution is empty.</p>
    <p>This "locked" mode is meant to limit the risks that the contract is used or exploited in a malicious way. It's probably been locked because it is being exploited in such a way and a new version of the contract is on its way for deployment. Locking is the only function of the contract under the central control of its owner. Please come back as soon as an unlocked version of this contract is deployed. For more information, contact sig at akasig dot org (see "About" link at the top right of this page).</p>
  </div>
</div>

<div class="ui fullscreen longer {{ web3ModalActivity }} modal">
  <div class="ui icon header">
    <i class="plug icon"></i>
    Connect to the blockchain
  </div>
  <div class="ui list">
   <div class="item" *ngIf="dappStatus()['statusWeb3']">
    <i class="check icon"></i>
    <div class="content">
      you are using an Ethereum browser
    </div>
   </div>
   <div class="item" *ngIf="!dappStatus()['statusWeb3']">
    <i class="x icon"></i>
    <div class="content">
      you must install and use an Ethereum browser
      <a href="https://metamask.io/" target="_blank"><button class="ui left labeled icon primary button">
       <i class="plug icon"></i>Install Metamask on PC
      </button></a>
      <a href="https://www.trustwallet.com/" target="_blank"><button class="ui left labeled icon primary button">
       <i class="plug icon"></i>Install Trust Wallet on mobile
      </button></a>
    </div>
   </div>
   <div class="item" *ngIf="dappStatus()['statusNetwork']">
    <i class="check icon"></i>
    <div class="content">
      your Ethereum browser is connected to the {{ revolutionBlockchain }} Ethereum blockchain network
    </div>
   </div>
   <div class="item" *ngIf="!dappStatus()['statusNetwork']">
    <i class="x icon"></i>
    <div class="content">
      your Ethereum browser must be connected to the {{ revolutionBlockchain }} Ethereum blockchain network
    </div>
   </div>
   <!--div class="item" *ngIf="dappStatus()['statusAccount']">
    <i class="check icon"></i>
    <div class="content">
      you are connected to a wallet within this Ethereum browser
    </div>
   </div>
   <div class="item" *ngIf="!dappStatus()['statusAccount']">
    <i class="x icon"></i>
    <div class="content">
      you must connect to a wallet within your Ethereum browser, (create a wallet if needed)
    </div>
   </div>
   <div class="item" *ngIf="dappStatus()['statusAuthorized']">
    <i class="check icon"></i>
    <div class="content">
      your Ethereum browser authorized interactions with the blockchain
    </div>
   </div>
   <div class="item" *ngIf="!dappStatus()['statusAuthorized']">
    <i class="x icon"></i>
    <div class="content">
      your Ethereum browser must authorize interactions with the blockchain
    </div>
   </div-->
 </div>
 Technical details:  <div class="content" [innerHTML]="web3Status">
  </div>
</div>

<div class="ui segment">
 <div class="header">
  <a href="https://{{ revolutionBlockchain == 'Main' || revolutionBlockchain == 'Mainnet' || revolutionBlockchain == 'Unknown' ? 'www' : revolutionBlockchain.toLowerCase() }}.etherscan.io/address/{{ revolutionAddress }}#events" target="_blank">Events of this revolution</a>
 </div>
 <!--div *ngIf="contractEvents">
 <div class="content" *ngFor="let cEvent of contractEvents.slice().reverse()">
  <a href="https://{{ revolutionBlockchain == 'Main' || revolutionBlockchain == 'Mainnet' || revolutionBlockchain == 'Unknown' ? 'www' : revolutionBlockchain.toLowerCase() }}.etherscan.io/tx/{{ cEvent.transactionHash }}#eventlog">#{{ cEvent.blockNumber }}{{ cEvent.logIndex ? ',' + cEvent.logIndex : '' }}: 
  <span *ngIf="cEvent.event == 'RevolutionCreated'">
	  this {{ cEvent.returnValues._hashtag }} revolution was created.
  </span>
  <span *ngIf="cEvent.event == 'TrialOpened'">
   the trial of {{ cEvent.returnValues._citizen | slice:0:8 }} opened.
  </span>
  <span *ngIf="cEvent.event == 'TrialClosed'">
   the trial of {{ cEvent.returnValues._citizen | slice:0:8 }} closed.
  </span>
  <span *ngIf="cEvent.event == 'VoteReceived'">
   {{ cEvent.returnValues._citizen | slice:0:8 }} received a  {{ cEvent.returnValues._vote ? 'YES' : 'NO' }} vote.
  </span>
  <span *ngIf="cEvent.event == 'Distribution'">
   {{ cEvent.returnValues._distributionAmount /  1000000000000000000 }} ETH was distributed to {{ cEvent.returnValues._citizen | slice:0:8 }}.
  </span>
  </a>
 </div>
 </div-->
</div>

